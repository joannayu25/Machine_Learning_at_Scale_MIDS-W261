(base) sta-c02q32lnfvh6:HW5 joannayu$ python3 submit_job_to_cluster.py \
>     --project_id='w261-fall-2019' \
>     --zone='us-west2-a' \
>     --cluster_name='w261hw5q8' \
>     --gcs_bucket='jyu-mids-w261-2019fall' \
>     --key_file=$HOME/w261.json \
>     --create_new_cluster \
>     --pyspark_file=pagerank.py \
>     --worker_nodes=6
Creating cluster...
Waiting for cluster creation...
Cluster created.
Uploading pyspark file to GCS
w261hw5q8 - RUNNING
Submitted job ID 1eefa08c-827c-4c5f-8899-21b569c85b93
Waiting for job to finish...
Job finished.
Downloading output file
Received job output b"Ivy Default Cache set to: /root/.ivy2/cache\nThe jars for the packages stored in: /root/.ivy2/jars\n:: loading settings :: url = jar:file:/usr/lib/spark/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml\ncom.databricks#spark-xml_2.11 added as a dependency\ngraphframes#graphframes added as a dependency\ncom.databricks#spark-avro_2.11 added as a dependency\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-6fb43b10-5f7c-4516-b65d-67702ca04c0e;1.0\n\tconfs: [default]\n\tfound com.databricks#spark-xml_2.11;0.4.1 in central\n\tfound graphframes#graphframes;0.7.0-spark2.3-s_2.11 in spark-packages\n\tfound org.slf4j#slf4j-api;1.7.16 in central\n\tfound com.databricks#spark-avro_2.11;4.0.0 in central\n\tfound org.apache.avro#avro;1.7.6 in central\n\tfound org.codehaus.jackson#jackson-core-asl;1.9.13 in central\n\tfound org.codehaus.jackson#jackson-mapper-asl;1.9.13 in central\n\tfound com.thoughtworks.paranamer#paranamer;2.3 in central\n\tfound org.xerial.snappy#snappy-java;1.0.5 in central\n\tfound org.apache.commons#commons-compress;1.4.1 in central\n\tfound org.tukaani#xz;1.0 in central\ndownloading https://repo1.maven.org/maven2/com/databricks/spark-xml_2.11/0.4.1/spark-xml_2.11-0.4.1.jar ...\n\t[SUCCESSFUL ] com.databricks#spark-xml_2.11;0.4.1!spark-xml_2.11.jar (5ms)\ndownloading http://dl.bintray.com/spark-packages/maven/graphframes/graphframes/0.7.0-spark2.3-s_2.11/graphframes-0.7.0-spark2.3-s_2.11.jar ...\n\t[SUCCESSFUL ] graphframes#graphframes;0.7.0-spark2.3-s_2.11!graphframes.jar (310ms)\ndownloading https://repo1.maven.org/maven2/com/databricks/spark-avro_2.11/4.0.0/spark-avro_2.11-4.0.0.jar ...\n\t[SUCCESSFUL ] com.databricks#spark-avro_2.11;4.0.0!spark-avro_2.11.jar (5ms)\ndownloading https://repo1.maven.org/maven2/org/slf4j/slf4j-api/1.7.16/slf4j-api-1.7.16.jar ...\n\t[SUCCESSFUL ] org.slf4j#slf4j-api;1.7.16!slf4j-api.jar (4ms)\ndownloading https://repo1.maven.org/maven2/org/apache/avro/avro/1.7.6/avro-1.7.6.jar ...\n\t[SUCCESSFUL ] org.apache.avro#avro;1.7.6!avro.jar(bundle) (8ms)\ndownloading https://repo1.maven.org/maven2/org/codehaus/jackson/jackson-core-asl/1.9.13/jackson-core-asl-1.9.13.jar ...\n\t[SUCCESSFUL ] org.codehaus.jackson#jackson-core-asl;1.9.13!jackson-core-asl.jar (6ms)\ndownloading https://repo1.maven.org/maven2/org/codehaus/jackson/jackson-mapper-asl/1.9.13/jackson-mapper-asl-1.9.13.jar ...\n\t[SUCCESSFUL ] org.codehaus.jackson#jackson-mapper-asl;1.9.13!jackson-mapper-asl.jar (9ms)\ndownloading https://repo1.maven.org/maven2/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar ...\n\t[SUCCESSFUL ] com.thoughtworks.paranamer#paranamer;2.3!paranamer.jar (2ms)\ndownloading https://repo1.maven.org/maven2/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar ...\n\t[SUCCESSFUL ] org.xerial.snappy#snappy-java;1.0.5!snappy-java.jar(bundle) (9ms)\ndownloading https://repo1.maven.org/maven2/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar ...\n\t[SUCCESSFUL ] org.apache.commons#commons-compress;1.4.1!commons-compress.jar (3ms)\ndownloading https://repo1.maven.org/maven2/org/tukaani/xz/1.0/xz-1.0.jar ...\n\t[SUCCESSFUL ] org.tukaani#xz;1.0!xz.jar (4ms)\n:: resolution report :: resolve 1765ms :: artifacts dl 374ms\n\t:: modules in use:\n\tcom.databricks#spark-avro_2.11;4.0.0 from central in [default]\n\tcom.databricks#spark-xml_2.11;0.4.1 from central in [default]\n\tcom.thoughtworks.paranamer#paranamer;2.3 from central in [default]\n\tgraphframes#graphframes;0.7.0-spark2.3-s_2.11 from spark-packages in [default]\n\torg.apache.avro#avro;1.7.6 from central in [default]\n\torg.apache.commons#commons-compress;1.4.1 from central in [default]\n\torg.codehaus.jackson#jackson-core-asl;1.9.13 from central in [default]\n\torg.codehaus.jackson#jackson-mapper-asl;1.9.13 from central in [default]\n\torg.slf4j#slf4j-api;1.7.16 from central in [default]\n\torg.tukaani#xz;1.0 from central in [default]\n\torg.xerial.snappy#snappy-java;1.0.5 from central in [default]\n\t:: evicted modules:\n\torg.slf4j#slf4j-api;1.7.5 by [org.slf4j#slf4j-api;1.7.16] in [default]\n\torg.slf4j#slf4j-api;1.6.4 by [org.slf4j#slf4j-api;1.7.16] in [default]\n\t---------------------------------------------------------------------\n\t|                  |            modules            ||   artifacts   |\n\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|\n\t---------------------------------------------------------------------\n\t|      default     |   13  |   11  |   11  |   2   ||   11  |   11  |\n\t---------------------------------------------------------------------\n:: retrieving :: org.apache.spark#spark-submit-parent-6fb43b10-5f7c-4516-b65d-67702ca04c0e\n\tconfs: [default]\n\t11 artifacts copied, 0 already retrieved (3708kB/23ms)\n19/11/08 02:29:54 INFO org.spark_project.jetty.util.log: Logging initialized @5844ms\n19/11/08 02:29:54 INFO org.spark_project.jetty.server.Server: jetty-9.3.z-SNAPSHOT, build timestamp: unknown, git hash: unknown\n19/11/08 02:29:54 INFO org.spark_project.jetty.server.Server: Started @5968ms\n19/11/08 02:29:54 INFO org.spark_project.jetty.server.AbstractConnector: Started ServerConnector@31010b68{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}\n19/11/08 02:29:54 WARN org.apache.spark.scheduler.FairSchedulableBuilder: Fair Scheduler configuration file not found so jobs will be scheduled in FIFO order. To use fair scheduling, configure pools in fairscheduler.xml or set spark.scheduler.allocation.file to a file that contains the configuration.\n19/11/08 02:29:55 INFO org.apache.hadoop.yarn.client.RMProxy: Connecting to ResourceManager at w261hw5q8-m/10.168.0.22:8032\n19/11/08 02:29:55 INFO org.apache.hadoop.yarn.client.AHSProxy: Connecting to Application History server at w261hw5q8-m/10.168.0.22:10200\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/com.databricks_spark-xml_2.11-0.4.1.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/graphframes_graphframes-0.7.0-spark2.3-s_2.11.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/com.databricks_spark-avro_2.11-4.0.0.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.slf4j_slf4j-api-1.7.16.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.apache.avro_avro-1.7.6.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.codehaus.jackson_jackson-core-asl-1.9.13.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.codehaus.jackson_jackson-mapper-asl-1.9.13.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/com.thoughtworks.paranamer_paranamer-2.3.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.xerial.snappy_snappy-java-1.0.5.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.apache.commons_commons-compress-1.4.1.jar added multiple times to distributed cache.\n19/11/08 02:29:58 WARN org.apache.spark.deploy.yarn.Client: Same path resource file:///root/.ivy2/jars/org.tukaani_xz-1.0.jar added multiple times to distributed cache.\n19/11/08 02:29:59 INFO org.apache.hadoop.yarn.client.api.impl.YarnClientImpl: Submitted application application_1573180117813_0001\n19/11/08 02:30:11 INFO org.apache.hadoop.mapred.FileInputFormat: Total input files to process : 1\nfinished Q7\n--->STEP 0: missing mass = 0.6194586236216252, total = 1.0000000000041753\n--->STEP 1: missing mass = 0.4962366552252807, total = 1.000000000006663\n--->STEP 2: missing mass = 0.4584589664013481, total = 1.0000000000035507\n--->STEP 3: missing mass = 0.4451862457982097, total = 1.000000000001256\n--->STEP 4: missing mass = 0.440201478187534, total = 1.0000000000055855\n--->STEP 5: missing mass = 0.43818412109728927, total = 1.0000000000042064\n--->STEP 6: missing mass = 0.43732676186415026, total = 1.0000000000042697\n--->STEP 7: missing mass = 0.4369451581452854, total = 1.000000000001954\n--->STEP 8: missing mass = 0.4367684897209292, total = 0.9999999999992589\n--->STEP 9: missing mass = 0.4366834304281386, total = 1.0000000000018014\n...trained 10 iterations in 2972.589043855667 seconds.\nTop 20 ranked nodes:\n[('13455888', 0.0015447247129833004), ('4695850', 0.0006710240718906512), ('5051368', 0.0005983856809747701), ('1184351', 0.0005982073536467376), ('2437837', 0.00046249289289407433), ('6076759', 0.00045509400641448197), ('4196067', 0.0004423778888372443), ('13425865', 0.000441553517143481), ('6172466', 0.0004224002001845022), ('1384888', 0.00040128956040736243), ('6113490', 0.0003957892477180541), ('14112583', 0.000394384728375477), ('7902219', 0.00037009878473569675), ('10390714', 0.0003650264964328284), ('12836211', 0.0003619948863114988), ('6237129', 0.0003519555847625281), ('6416278', 0.00034866235645266395), ('13432150', 0.00033936510637418247), ('1516699', 0.00033297500286244206), ('7990491', 0.0003076090626586913)]\n19/11/08 03:19:46 INFO org.spark_project.jetty.server.AbstractConnector: Stopped Spark@31010b68{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}\n"
Tearing down cluster